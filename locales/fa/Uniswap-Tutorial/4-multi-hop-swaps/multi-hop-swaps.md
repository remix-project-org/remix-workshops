در این بخش، به بررسی تابع `swapExactInputMultiHop` در قرارداد `UniswapV3SwapExamples` خواهیم پرداخت. این تابع امکان تبادل توکن‌های پیچیده‌تر را با اجازه دادن به کاربران برای تعیین یک مسیر سفارشی از طریق چندین استخر نقدینگی فراهم می‌کند.

به عنوان مثال، اگر یک کاربر بخواهد توکن A را با توکن D مبادله کند، اما استخر نقدینگی مستقیمی برای A و D وجود نداشته باشد، کاربر می‌تواند مسیری را از طریق چندین توکن مشخص کند. به عنوان مثال، کاربر می‌تواند A را با B عوض کند، سپس B را با C و در نهایت C را با D عوض کند. این کار البته به‌طور خودکار توسط قرارداد تعویض Uniswap V3 انجام می‌شود.

### پارامترها و مقدار بازگشتی

در خط ۳۲، یک تابع به نام `swapExactInputMultiHop` تعریف می‌کنیم. این تابع یک تعویض چند مرحله‌ای را اجرا می‌کند. این پارامترهای زیر را می‌گیرد:

- **`bytes calldata path`**: اطلاعات کدگذاری شده درباره مسیر مبادله (یعنی کدام توکن‌ها باید مبادله شوند).
- **`آدرس tokenIn`**: آدرس توکنی که در حال ارسال است.
- **`uint amountIn`**: مقدار توکن ورودی که ارسال می‌شود.

این یک `uint` به نام `amountOut` برمی‌گرداند، که مقدار توکن خروجی دریافتی است.

### بدنه تابع

درون بدنه تابع، ابتدا توکن ورودی را از فرستنده به قرارداد خودمان منتقل می‌کنیم، خط ۳۸.
سپس، ما روتر مبادله یونی‌سواپ را برای هزینه کردن توکن ورودی به نمایندگی از خود تایید می‌کنیم، خط ۴۱.

در خط ۴۳، ما یک نمونه از ساختار `ExactInputParams` را ایجاد می‌کنیم، خط ۷۳. این ساختار شامل پارامترهایی است که برای تابع `exactInput` ما در خط 81 مورد نیاز است و این تابع تعویض چند مرحله‌ای را اجرا خواهد کرد.

ما پارامترهای ساختار را به صورت زیر تنظیم می‌کنیم:

- **`path`**: ما این را به پارامتر `path` تابع خود تنظیم کردیم.
- **`گیرنده`**: ما این را به فرستنده تراکنش تنظیم می‌کنیم.
- **`موعد نهایی`**: ما این را به زمان حال تعیین می‌کنیم. ما این کار را انجام می‌دهیم زیرا می‌خواهیم تراکنش در اسرع وقت پردازش شود.
- **`amountIn`**: ما این را به پارامتر `amountIn` تابع خود تنظیم می‌کنیم.
- **`مقدارخروجحداقل`**: ما این را برابر با 0 قرار می‌دهیم زیرا نمی‌خواهیم مقدار حداقلی از توکن خروجی که مایل به پذیرش آن هستیم را مشخص کنیم.

در خط ۵۳، ما تعویض چند مرحله‌ای را با فراخوانی تابع `exactInput` اجرا می‌کنیم. این تابع مقدار توکن خروجی که دریافت شده است را برمی‌گرداند.