تبادلات تک‌گام به کاربران اجازه می‌دهد تا یک توکن را مستقیماً در یک استخر نقدینگی با توکن دیگر مبادله کنند. در این بخش، ما یاد خواهیم گرفت که چگونه از قرارداد مبادله Uniswap V3 برای انجام مبادلات تک مرحله‌ای استفاده کنیم.

## پارامترهای تابع

در خط 8، یک تابع به نام `swapExactInputSingleHop` تعریف می‌کنیم. این تابع یک تعویض یک مرحله‌ای را اجرا می‌کند. این پارامترهای زیر را می‌گیرد:

- **`نشانی توکن`**: نشانی توکنی که در حال ارسال است.
- **`آدرس tokenOut`**: آدرس توکنی که دریافت می‌شود.
- **`uint24 poolFee`**: هزینه مربوط به تعویض.
- **`uint amountIn`**: مقدار توکن ورودی که ارسال می‌شود.

این یک `uint` به نام `amountOut` برمی‌گرداند، که مقدار توکن خروجی دریافتی است.

## بدنه تابع

درون بدنه تابع، ابتدا توکن ورودی را از فرستنده به قرارداد خود منتقل می‌کنیم، خط ۱۴.
سپس، ما قرارداد مبادله یونی سwap را برای هزینه کردن توکن ورودی به نمایندگی از خودمان تأیید می‌کنیم، خط ۱۵.

در خط 17، یک نمونه از ساختار `ExactInputSingleParams` ایجاد می‌کنیم. این ساختار شامل پارامترهایی است که برای تابع `exactInputSingle` ما در خط ۴۵ مورد نیاز است، که مبادله یک مرحله‌ای را اجرا خواهد کرد. ما `ISwapRouter.ExactInputSingleParams` را در آن خط دو بار تکرار می‌کنیم زیرا داریم یک نمونه از یک ساختار که در یک رابط تعریف شده است، ایجاد می‌کنیم.

## پارامترهای ساختار ExactInputSingleParams

ما پارامترهای ساختار را به صورت زیر تنظیم می‌کنیم:

- **`tokenIn`**: ما این را به پارامتر `tokenIn` تابع خود تنظیم می‌کنیم.
- **`tokenOut`**: ما این را به پارامتر `tokenOut` تابع خود تنظیم می‌کنیم.
- **`هزینه`**: ما این را به پارامتر `poolFee` تابع خود تنظیم می‌کنیم.
- **`گیرنده`**: ما این را به فرستنده تراکنش تنظیم می‌کنیم.
- **`موعد نهایی`**: ما این را به زمان حال تعیین می‌کنیم. ما این کار را انجام می‌دهیم زیرا می‌خواهیم تراکنش در اسرع وقت پردازش شود.
- **`amountIn`**: ما این را به پارامتر `amountIn` تابع خود تنظیم می‌کنیم.
- **`مقدارخروجحداقل`**: ما این مقدار را به 0 تنظیم می‌کنیم زیرا نمی‌خواهیم حداقل مقدار توکن خروجی که مایل به پذیرش آن هستیم را مشخص کنیم.
- **`sqrtPriceLimitX96`**: ما این را 0 تنظیم می‌کنیم زیرا نمی‌خواهیم محدودیتی برای قیمت تعیین کنیم.

## اجرای مبادله یک مرحله‌ای

در خط ۲۹، خروجی تابع `exactInputSingle` را به متغیر `amountOut` نسبت می‌دهیم. این تابع تعویض یک جهته را اجرا می‌کند و مقدار توکن خروجی که دریافت شده است را باز می‌گرداند.