در این مرحله، ما مثالی از نحوه ارسال یک پیام عمومی بین یک بلاکچین به بلاکچین دیگر را بررسی کردیم. حال، بیایید قراردادی را پیاده‌سازی کنیم که یک پیام و یک توکن را از یک بلاکچین به بلاکچین دیگر ارسال کند.

## نمای کلی

این قرارداد باید تا حد زیادی آشنا به نظر برسد. بسیار شبیه به بخش قبلی، «سازنده» آدرس‌های «دروازه» و «سرویس گاز» را دریافت می‌کند.

سپس تابعی به نام `sendToMany` دارد که از زنجیره منبع فراخوانی می‌شود و پارامترهایی مشابه بخش قبل را دریافت می‌کند.

1. `_destinationChain`: زنجیره‌ای که تراکنش به آن ارسال می‌شود
2. `_destinationAddress`: آدرسی در زنجیره مقصد که تراکنش شما به آن ارسال می‌شود
3. `_destinationAddresses`: پیامی که همراه با انتقال توکن خود ارسال خواهید کرد. در این مثال، پیام، فهرستی از آدرس‌های دریافت‌کننده برای انتقال توکن است.
4. `_symbol`: نماد آدرس توکن ارسالی
5. `_amount`: مقدار توکنی که ارسال می‌شود

در تابع، ما از قبل دستور `require` را برای اطمینان از ارسال گاز پیاده‌سازی کرده‌ایم

ما همچنین قابلیت پایه ERC20 را برای ارسال توکن از کیف پول فراخوان به این قرارداد هوشمند داریم. این قرارداد همچنین تابع «تأیید» را فراخوانی می‌کند تا به Gateway اجازه دهد در نهایت از طرف آن وجه منتقل کند.

در نهایت، تابع `_executeWithToken()` نیز به صورت پیش‌فرض پیاده‌سازی شده است.

از پارامترهای زیر استفاده می‌کند:

1. `_payload`: پیام ورودی از زنجیره منبع
2. `_tokenSymbol`: نماد توکنی که از زنجیره منبع ارسال شده است
3. `_amount`: مقدار توکنی که از زنجیره منبع ارسال شده است

اکنون با این پارامترهایی که ارسال شده‌اند، تابع `_execute()` می‌تواند توکن‌هایی را که به گیرنده‌های مناسب ارسال شده‌اند، ارسال کند.

## چالش

چالش شما در اینجا این است که تابع `sendToMany()` را با استفاده از دروازه Axelar و سرویس Gas برای ایجاد یک تراکنش بین زنجیره‌ای به پایان برسانید.

در نهایت شما باید بتوانید این قرارداد را روی دو شبکه آزمایشی مستقر کنید، تابع `sendToMany()` را فعال کنید و تراکنش زنده را در <a href="https://testnet.axelarscan.io" target="_blank">کاوشگر بلوک Axelarscan (شبکه آزمایشی)</a> مشاهده کنید.

### یادداشت های آزمایشی

نکته ۱: ERC20 پیشنهادی برای استفاده، «aUSDC» است، یک نسخه پیچیده شده از توکن USDC که می‌توان آن را از <a href= "https://docs.axelar.dev/resources/rpc/resources" target="_blank">ربات دیسکورد فاست</a> دریافت کرد. هنگام فعال‌سازی تابع `sendToMany()`، کافیست نماد `aUSDC` را به پارامتر چهارم ارسال کنید.

نکته2: هنگام فعال‌سازی تابع `sendToMany()`، باید به خاطر داشته باشید که قرارداد خود را برای خرج کردن توکن‌های `aUSDC` از طرف خود `تأیید` کنید، در غیر این صورت `transferFrom()` در خط۴۹ خطا می‌دهد.
